<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenLcbCLib: src/openlcb/protocol_message_network.c File Reference</title>
<link rel="icon" href="Diesel.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenLcbCLib<span id="projectnumber">&#160;1.0 Alpha</span>
   </div>
   <div id="projectbrief">OpenSource C Library to create OpenLcb/Lcc Nodes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2e7e6c944bd9908e2f8181efb624bb5a.html">openlcb</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">protocol_message_network.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of core message network protocol.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6de2e392dcc8fc3e752b535e822ad275" id="r_a6de2e392dcc8fc3e752b535e822ad275"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6de2e392dcc8fc3e752b535e822ad275">ProtocolMessageNetwork_initialize</a> (const <a class="el" href="structinterface__openlcb__protocol__message__network__t.html">interface_openlcb_protocol_message_network_t</a> *interface_openlcb_protocol_message_network)</td></tr>
<tr class="memdesc:a6de2e392dcc8fc3e752b535e822ad275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the Message Network protocol layer.  <br /></td></tr>
<tr class="separator:a6de2e392dcc8fc3e752b535e822ad275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44398b4a2a77c1dd13e6ce579e4c45b" id="r_ae44398b4a2a77c1dd13e6ce579e4c45b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae44398b4a2a77c1dd13e6ce579e4c45b">ProtocolMessageNetwork_handle_initialization_complete</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:ae44398b4a2a77c1dd13e6ce579e4c45b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Initialization Complete message.  <br /></td></tr>
<tr class="separator:ae44398b4a2a77c1dd13e6ce579e4c45b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94fa4c988fd24bfc527f373ef3c89e2b" id="r_a94fa4c988fd24bfc527f373ef3c89e2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94fa4c988fd24bfc527f373ef3c89e2b">ProtocolMessageNetwork_handle_initialization_complete_simple</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a94fa4c988fd24bfc527f373ef3c89e2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Initialization Complete Simple message.  <br /></td></tr>
<tr class="separator:a94fa4c988fd24bfc527f373ef3c89e2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c1bd7d18c6b20c915f1ff93d953687d" id="r_a2c1bd7d18c6b20c915f1ff93d953687d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c1bd7d18c6b20c915f1ff93d953687d">ProtocolMessageNetwork_handle_protocol_support_inquiry</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a2c1bd7d18c6b20c915f1ff93d953687d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Protocol Support Inquiry message.  <br /></td></tr>
<tr class="separator:a2c1bd7d18c6b20c915f1ff93d953687d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a00748f7b094019ef0743f7d1a0fc65" id="r_a6a00748f7b094019ef0743f7d1a0fc65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a00748f7b094019ef0743f7d1a0fc65">ProtocolMessageNetwork_handle_protocol_support_reply</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a6a00748f7b094019ef0743f7d1a0fc65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Protocol Support Reply message.  <br /></td></tr>
<tr class="separator:a6a00748f7b094019ef0743f7d1a0fc65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24ea265253588c2f4e1c8bfc67073fa8" id="r_a24ea265253588c2f4e1c8bfc67073fa8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24ea265253588c2f4e1c8bfc67073fa8">ProtocolMessageNetwork_handle_verify_node_id_global</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a24ea265253588c2f4e1c8bfc67073fa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles global Verify Node ID message.  <br /></td></tr>
<tr class="separator:a24ea265253588c2f4e1c8bfc67073fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2bdbb0e461bfb459ff560f3fe6a215" id="r_a7b2bdbb0e461bfb459ff560f3fe6a215"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b2bdbb0e461bfb459ff560f3fe6a215">ProtocolMessageNetwork_handle_verify_node_id_addressed</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a7b2bdbb0e461bfb459ff560f3fe6a215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles addressed Verify Node ID message.  <br /></td></tr>
<tr class="separator:a7b2bdbb0e461bfb459ff560f3fe6a215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc5050fc4c003790bd5deb876fcf842" id="r_a6cc5050fc4c003790bd5deb876fcf842"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cc5050fc4c003790bd5deb876fcf842">ProtocolMessageNetwork_handle_verified_node_id</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a6cc5050fc4c003790bd5deb876fcf842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Verified Node ID message.  <br /></td></tr>
<tr class="separator:a6cc5050fc4c003790bd5deb876fcf842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28784d330fe4b9dc5edaae0e0ed25970" id="r_a28784d330fe4b9dc5edaae0e0ed25970"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28784d330fe4b9dc5edaae0e0ed25970">ProtocolMessageNetwork_handle_optional_interaction_rejected</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:a28784d330fe4b9dc5edaae0e0ed25970"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Optional Interaction Rejected message.  <br /></td></tr>
<tr class="separator:a28784d330fe4b9dc5edaae0e0ed25970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5696bf1ec10b7d0d07097a6cbc33fc4" id="r_ad5696bf1ec10b7d0d07097a6cbc33fc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5696bf1ec10b7d0d07097a6cbc33fc4">ProtocolMessageNetwork_handle_terminate_due_to_error</a> (<a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *statemachine_info)</td></tr>
<tr class="memdesc:ad5696bf1ec10b7d0d07097a6cbc33fc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles Terminate Due To Error message.  <br /></td></tr>
<tr class="separator:ad5696bf1ec10b7d0d07097a6cbc33fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of core message network protocol. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024, Jim Kueneman All rights reserved.</dd></dl>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<dl class="section author"><dt>Author</dt><dd>Jim Kueneman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>17 Jan 2026 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6de2e392dcc8fc3e752b535e822ad275" name="a6de2e392dcc8fc3e752b535e822ad275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6de2e392dcc8fc3e752b535e822ad275">&#9670;&#160;</a></span>ProtocolMessageNetwork_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_initialize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structinterface__openlcb__protocol__message__network__t.html">interface_openlcb_protocol_message_network_t</a> *</td>          <td class="paramname"><span class="paramname"><em>interface_openlcb_protocol_message_network</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the Message Network protocol layer. </p>
<p>Algorithm:</p><ol type="1">
<li>Store pointer to callback interface in static variable</li>
<li>Interface remains valid for application lifetime</li>
</ol>
<p>Use cases:</p><ul>
<li>Called during application startup</li>
<li>Required before processing any OpenLCB messages</li>
</ul>
<pre class="fragment">* @param interface_openlcb_protocol_message_network Pointer to callback interface structure
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must remain valid for lifetime of application </dd>
<dd>
NOT thread-safe - call during single-threaded initialization only</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>Call before enabling CAN message reception </dd>
<dd>
Currently no callbacks are registered, but interface is maintained for consistency</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structinterface__openlcb__protocol__message__network__t.html" title="Interface structure for Message Network protocol callbacks.">interface_openlcb_protocol_message_network_t</a> - Callback interface structure </dd></dl>

</div>
</div>
<a id="ae44398b4a2a77c1dd13e6ce579e4c45b" name="ae44398b4a2a77c1dd13e6ce579e4c45b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae44398b4a2a77c1dd13e6ce579e4c45b">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_initialization_complete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_initialization_complete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Initialization Complete message. </p>
<p>Algorithm:</p><ol type="1">
<li>Mark outgoing message as invalid (no automatic response required)</li>
</ol>
<p>Use cases:</p><ul>
<li>Detecting new nodes joining the network</li>
<li>Updating node discovery tables</li>
<li>Triggering configuration queries to new nodes</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always sets outgoing_msg_info.valid to false (no automatic response) </dd>
<dd>
Full initialization complete includes complete node capabilities </dd>
<dd>
Application can monitor for this message to detect new nodes</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a94fa4c988fd24bfc527f373ef3c89e2b" title="Handles Initialization Complete Simple message.">ProtocolMessageNetwork_handle_initialization_complete_simple</a> - Simple node version </dd></dl>

</div>
</div>
<a id="a94fa4c988fd24bfc527f373ef3c89e2b" name="a94fa4c988fd24bfc527f373ef3c89e2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94fa4c988fd24bfc527f373ef3c89e2b">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_initialization_complete_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_initialization_complete_simple </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Initialization Complete Simple message. </p>
<p>Algorithm:</p><ol type="1">
<li>Mark outgoing message as invalid (no automatic response required)</li>
</ol>
<p>Use cases:</p><ul>
<li>Detecting simple nodes joining the network</li>
<li>Distinguishing simple from full nodes</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always sets outgoing_msg_info.valid to false (no automatic response) </dd>
<dd>
Simple nodes implement a subset of the full protocol </dd>
<dd>
Application can monitor for this message to detect simple nodes</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ae44398b4a2a77c1dd13e6ce579e4c45b" title="Handles Initialization Complete message.">ProtocolMessageNetwork_handle_initialization_complete</a> - Full node version </dd></dl>

</div>
</div>
<a id="a2c1bd7d18c6b20c915f1ff93d953687d" name="a2c1bd7d18c6b20c915f1ff93d953687d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c1bd7d18c6b20c915f1ff93d953687d">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_protocol_support_inquiry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_protocol_support_inquiry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Protocol Support Inquiry message. </p>
<p>Algorithm:</p><ol type="1">
<li>Read protocol support flags from node parameters</li>
<li>If firmware upgrade is active:<ul>
<li>Clear FIRMWARE_UPGRADE bit</li>
<li>Set FIRMWARE_UPGRADE_ACTIVE bit</li>
</ul>
</li>
<li>Construct Protocol Support Reply message</li>
<li>Set source to this node's alias and ID</li>
<li>Set destination to requesting node's alias and ID</li>
<li>Copy 6 bytes of protocol support flags to payload:<ul>
<li>Byte 0: Upper 8 bits of support flags</li>
<li>Byte 1: Middle 8 bits of support flags</li>
<li>Byte 2: Lower 8 bits of support flags</li>
<li>Bytes 3-5: Reserved (0x00)</li>
</ul>
</li>
<li>Mark outgoing message as valid</li>
</ol>
<p>Use cases:</p><ul>
<li>Configuration tools discovering node capabilities</li>
<li>Protocol negotiation between nodes</li>
<li>Feature detection</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Constructs and sends Protocol Support Reply message </dd>
<dd>
Support flags are read from node's parameters structure </dd>
<dd>
Handles firmware upgrade state specially </dd>
<dd>
Payload count is set automatically by OpenLcbUtilities_copy_byte_to_openlcb_payload</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a6a00748f7b094019ef0743f7d1a0fc65" title="Handles Protocol Support Reply message.">ProtocolMessageNetwork_handle_protocol_support_reply</a> - Handles responses </dd></dl>

</div>
</div>
<a id="a6a00748f7b094019ef0743f7d1a0fc65" name="a6a00748f7b094019ef0743f7d1a0fc65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a00748f7b094019ef0743f7d1a0fc65">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_protocol_support_reply()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_protocol_support_reply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Protocol Support Reply message. </p>
<p>Algorithm:</p><ol type="1">
<li>Mark outgoing message as invalid (no automatic response required)</li>
</ol>
<p>Use cases:</p><ul>
<li>Receiving protocol capabilities from remote nodes</li>
<li>Building node capability tables</li>
<li>Adapting communication based on remote capabilities</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always sets outgoing_msg_info.valid to false (no automatic response) </dd>
<dd>
Application can extract capability flags from incoming message payload</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a2c1bd7d18c6b20c915f1ff93d953687d" title="Handles Protocol Support Inquiry message.">ProtocolMessageNetwork_handle_protocol_support_inquiry</a> - Triggers this response </dd></dl>

</div>
</div>
<a id="a24ea265253588c2f4e1c8bfc67073fa8" name="a24ea265253588c2f4e1c8bfc67073fa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24ea265253588c2f4e1c8bfc67073fa8">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_verify_node_id_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_verify_node_id_global </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles global Verify Node ID message. </p>
<p>Algorithm:</p><ol type="1">
<li>Check if message payload contains a Node ID (payload_count &gt; 0)</li>
<li>If payload contains Node ID:<ul>
<li>Extract the Node ID from payload</li>
<li>Compare with this node's ID</li>
<li>If match: Call _load_verified_node_id() to prepare response</li>
<li>If no match: Mark outgoing message as invalid (no response)</li>
<li>Return to caller</li>
</ul>
</li>
<li>If payload is empty (global request):<ul>
<li>Call _load_verified_node_id() to prepare response</li>
</ul>
</li>
</ol>
<p>Use cases:</p><ul>
<li>Network-wide node discovery</li>
<li>Verifying presence of specific node</li>
<li>Detecting duplicate Node IDs</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If payload contains Node ID, only responds if it matches this node </dd>
<dd>
If payload is empty, responds unconditionally (global request) </dd>
<dd>
Response is either Verified Node ID or Verified Node ID Simple</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a7b2bdbb0e461bfb459ff560f3fe6a215" title="Handles addressed Verify Node ID message.">ProtocolMessageNetwork_handle_verify_node_id_addressed</a> - Addressed version </dd>
<dd>
<a class="el" href="#a6cc5050fc4c003790bd5deb876fcf842" title="Handles Verified Node ID message.">ProtocolMessageNetwork_handle_verified_node_id</a> - Response message handler </dd></dl>

</div>
</div>
<a id="a7b2bdbb0e461bfb459ff560f3fe6a215" name="a7b2bdbb0e461bfb459ff560f3fe6a215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2bdbb0e461bfb459ff560f3fe6a215">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_verify_node_id_addressed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_verify_node_id_addressed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles addressed Verify Node ID message. </p>
<p>Algorithm:</p><ol type="1">
<li>Call _load_verified_node_id() to prepare Verified Node ID response</li>
</ol>
<p>Use cases:</p><ul>
<li>Targeted node verification</li>
<li>Confirming node is still online</li>
<li>Directed discovery</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always responds (message is addressed to this node) </dd>
<dd>
Response is either Verified Node ID or Verified Node ID Simple</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a24ea265253588c2f4e1c8bfc67073fa8" title="Handles global Verify Node ID message.">ProtocolMessageNetwork_handle_verify_node_id_global</a> - Broadcast version </dd>
<dd>
<a class="el" href="#a6cc5050fc4c003790bd5deb876fcf842" title="Handles Verified Node ID message.">ProtocolMessageNetwork_handle_verified_node_id</a> - Response message handler </dd></dl>

</div>
</div>
<a id="a6cc5050fc4c003790bd5deb876fcf842" name="a6cc5050fc4c003790bd5deb876fcf842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc5050fc4c003790bd5deb876fcf842">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_verified_node_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_verified_node_id </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Verified Node ID message. </p>
<p>Algorithm:</p><ol type="1">
<li>Extract Node ID from incoming message payload</li>
<li>Compare extracted ID with this node's ID</li>
<li>If IDs match (duplicate detected):<ul>
<li>Call _load_duplicate_node_id() to prepare error event</li>
<li>Return to caller</li>
</ul>
</li>
<li>If IDs don't match:<ul>
<li>Mark outgoing message as invalid (no response needed)</li>
</ul>
</li>
</ol>
<p>Use cases:</p><ul>
<li>Detecting duplicate Node IDs on the network</li>
<li>Learning about other nodes on the network</li>
<li>Node discovery and tracking</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If Node ID matches this node, sends Duplicate Node Detected event </dd>
<dd>
Duplicate detection only triggers once per boot </dd>
<dd>
If Node IDs don't match, no response is generated</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a24ea265253588c2f4e1c8bfc67073fa8" title="Handles global Verify Node ID message.">ProtocolMessageNetwork_handle_verify_node_id_global</a> - Triggers this message </dd>
<dd>
<a class="el" href="#a7b2bdbb0e461bfb459ff560f3fe6a215" title="Handles addressed Verify Node ID message.">ProtocolMessageNetwork_handle_verify_node_id_addressed</a> - Triggers this message </dd></dl>

</div>
</div>
<a id="a28784d330fe4b9dc5edaae0e0ed25970" name="a28784d330fe4b9dc5edaae0e0ed25970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28784d330fe4b9dc5edaae0e0ed25970">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_optional_interaction_rejected()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_optional_interaction_rejected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Optional Interaction Rejected message. </p>
<p>Algorithm:</p><ol type="1">
<li>Mark outgoing message as invalid (no automatic response required)</li>
</ol>
<p>Use cases:</p><ul>
<li>Handling feature negotiation failures</li>
<li>Detecting unsupported protocols on remote nodes</li>
<li>Graceful degradation when features unavailable</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always sets outgoing_msg_info.valid to false (no automatic response) </dd>
<dd>
Application should check for this after sending optional protocol requests</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a2c1bd7d18c6b20c915f1ff93d953687d" title="Handles Protocol Support Inquiry message.">ProtocolMessageNetwork_handle_protocol_support_inquiry</a> - Proactive capability checking </dd></dl>

</div>
</div>
<a id="ad5696bf1ec10b7d0d07097a6cbc33fc4" name="ad5696bf1ec10b7d0d07097a6cbc33fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5696bf1ec10b7d0d07097a6cbc33fc4">&#9670;&#160;</a></span>ProtocolMessageNetwork_handle_terminate_due_to_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProtocolMessageNetwork_handle_terminate_due_to_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structopenlcb__statemachine__info__t.html">openlcb_statemachine_info_t</a> *</td>          <td class="paramname"><span class="paramname"><em>statemachine_info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles Terminate Due To Error message. </p>
<p>Algorithm:</p><ol type="1">
<li>Mark outgoing message as invalid (no automatic response required)</li>
</ol>
<p>Use cases:</p><ul>
<li>Detecting serious errors in remote nodes</li>
<li>Cleaning up resources associated with failed node</li>
<li>Error logging and diagnostics</li>
</ul>
<pre class="fragment">* @param statemachine_info Pointer to state machine context containing incoming message
* </pre><dl class="section warning"><dt>Warning</dt><dd>Pointer must NOT be NULL</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Always sets outgoing_msg_info.valid to false (no automatic response) </dd>
<dd>
Error details may be in message payload </dd>
<dd>
This indicates a serious problem in the remote node </dd></dl>

</div>
</div>
</div><!-- contents -->
<!doctype html>
<html>
    <body>
        <hr>
        <p style="margin-left: 10px; margin-right: 10px;">
            <b>Copyright (c)</b> 2026 Jim Kueneman all rights reserved. See the <a href="../licence.html">License</a>
        </p>
    </body>
</html>
